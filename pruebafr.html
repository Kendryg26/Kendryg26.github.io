<html lang="es">
<head>
    <script src="//cdn.jsdelivr.net/npm/@clappr/player@0.4.0/dist/clappr.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/mux.js@5.6.7/dist/mux.min.js"></script>
    <script src='//cdn.jsdelivr.net/npm/level-selector@latest/dist/level-selector.min.js'></script>
    <script src='//cdn.jsdelivr.net/npm/clappr-chromecast-plugin@latest/dist/clappr-chromecast-plugin.min.js'></script>
    <script src='//cdn.jsdelivr.net/npm/clappr-pip@latest/dist/clappr-pip.min.js'></script>
    <script src='//cdn.jsdelivr.net/npm/clappr-playback-rate-plugin@latest/dist/clappr-playback-rate-plugin.min.js'></script>
    <script src="//cdn.jsdelivr.net/npm/shaka-player@2.5.10/dist/shaka-player.compiled.min.js"></script>
    <script src="//cdn.jsdelivr.net/gh/clappr/dash-shaka-playback@latest/dist/dash-shaka-playback.external.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/cdnbye-shaka@latest"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script> 
    <style> 
        .player-poster[data-poster] {
            background-size: cover;
        }
        body {
            margin:0;
            padding:0;
        }
    </style>
</head>
<body>
    <div id="player"></div>

    <script>
        $.ajax({
            url: 'https://api.codetabs.com/v1/proxy/?quest=https://maindota2.co/php/forja/lequipe.php', 
            method: 'GET',
            success: function(response) {
                var data = JSON.parse(response);

                // Construye la URL completa con el proxy
                var proxyUrl = 'https://vladimirputin.onrender.com/';
                var sourceUrl = decodeURIComponent(data.source);
                var fullUrl = proxyUrl + sourceUrl;

                var player = new Clappr.Player({
                    source: fullUrl,
                    mimeType: 'application/dash+xml',
                    height: '100%',
                    width: '100%',
                    plugins: [LevelSelector, DashShakaPlayback, ChromecastPlugin, ClapprPip.PipButton, ClapprPip.PipPlugin, Clappr.MediaControl],
                    events: {
                        onReady: function() {
                            var plugin = this.getPlugin('click_to_pause');
                            plugin && plugin.disable();
                        },
                    },
                    chromecast: {
                        appId: '9DFB77C0',
                        contentType: 'video/mp4',
                    },
                    shakaConfiguration: {
                        drm: {
                            clearKeys: {
                                '5a3904fae05549b7bdaec9dd2ddfdead': '458ead86f19b133e74da4a4d1909ea55',
                                '90a8786603ac4d8c8c774e2d1643dc52':
                                '34d101e7b2883eddd3c526b1c7449c55',
                                'bd1e05a3deff494a948cd00ffe04a9ae':
                                '386c45c628b435bb598e1ff95e91aa8e',
                                'e5be0501d2f84b3f827868e75ce01f2b':
                                '057422d3352cb71a3704df379494d477'
                            }
                        },
                        preferredAudioLanguage: 'pt-BR',
                    },
                    parentId: '#player'
                });
            },
            error: function() {
                console.error('Error al obtener la URL con token.');
            }
        });
    </script>
</body>
</html>
